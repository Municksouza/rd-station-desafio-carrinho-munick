{
  "version": 3,
  "sources": ["../js/dom.js", "../js/api.js", "../js/cart.js", "../js/products.js", "../js/main.js"],
  "sourcesContent": ["export const $  = (sel, root = document) => root.querySelector(sel);\nexport const $$ = (sel, root = document) => [...root.querySelectorAll(sel)];\n\nexport function el(tag, attrs = {}, children = []) {\n  const node = document.createElement(tag);\n  Object.entries(attrs).forEach(([k, v]) => {\n    if (k === 'class') node.className = v;\n    else if (k.startsWith('on') && typeof v === 'function') node.addEventListener(k.slice(2), v);\n    else node.setAttribute(k, v);\n  });\n  (Array.isArray(children) ? children : [children]).forEach((c) => {\n    if (c == null) return;\n    node.appendChild(typeof c === 'string' ? document.createTextNode(c) : c);\n  });\n  return node;\n}\n\nexport function mount(root, child) {\n  root.innerHTML = '';\n  (Array.isArray(child) ? child : [child]).forEach((c) => root.appendChild(c));\n}\n", "/**\n * api.js \u2014 Camada de comunica\u00E7\u00E3o com a API Rails.\n * Todas as requisi\u00E7\u00F5es passam por aqui, garantindo\n * padroniza\u00E7\u00E3o e tratamento de erros.\n *\n * Endpoints (namespace /api):\n *  - GET    /api/products\n *  - GET    /api/cart\n *  - POST   /api/cart\n *  - POST   /api/cart/add_item\n *  - DELETE /api/cart/:id\n */\n\nexport const API = {\n  /**\n   * M\u00E9todo base para todas as requisi\u00E7\u00F5es HTTP.\n   * Lida com erros e converte a resposta para JSON automaticamente.\n   */\n  async request(url, options = {}) {\n    const config = {\n      headers: { 'Content-Type': 'application/json' },\n      credentials: 'same-origin', // mant\u00E9m cookies de sess\u00E3o\n      ...options,\n    };\n\n    try {\n      const response = await fetch(url, config);\n\n      // Lida com erros HTTP\n      if (!response.ok) {\n        const message = `Erro ${response.status}: ${response.statusText}`;\n        console.error(`\u274C [API Error] ${message}`);\n        throw new Error(message);\n      }\n\n      // Retorna o JSON parseado (ou objeto vazio se falhar)\n      const data = await response.json().catch(() => ({}));\n      return data;\n\n    } catch (error) {\n      console.error(\"\uD83D\uDEA8 Falha na requisi\u00E7\u00E3o:\", error);\n      alert(\"\u26A0\uFE0F Erro ao se comunicar com o servidor. Tente novamente.\");\n      return { products: [], total_price: 0 };\n    }\n  },\n\n  // === Produtos ===\n\n  /**\n   * Busca todos os produtos dispon\u00EDveis.\n   * @returns {Promise<Array>} Lista de produtos.\n   */\n  getProducts() {\n    return this.request('/api/products');\n  },\n\n  /**\n   * Busca um produto espec\u00EDfico (opcional).\n   * @param {number} id - ID do produto.\n   * @returns {Promise<Object>} Produto.\n   */\n  getProduct(id) {\n    return this.request(`/api/products/${id}`);\n  },\n\n  // === Carrinho ===\n\n  /**\n   * Retorna o carrinho atual (cria um se n\u00E3o existir).\n   * @returns {Promise<Object>} Carrinho.\n   */\n  getCart() {\n    return this.request('/api/cart');\n  },\n\n/**\n * Adiciona um produto ao carrinho.\n * Cria o carrinho automaticamente se necess\u00E1rio.\n * @param {number} productId - ID do produto.\n * @param {number} quantity - Quantidade desejada.\n * @returns {Promise<Object>} Carrinho atualizado.\n */\naddToCart(productId, quantity = 1) {\n  return this.request('/api/cart/add_item', {\n    method: 'POST',\n    body: JSON.stringify({ product_id: productId, quantity }),\n  });\n},\n\n/**\n * Atualiza a quantidade de um item existente no carrinho.\n * @param {number} productId - ID do produto.\n * @param {number} quantity - Quantidade adicional.\n * @returns {Promise<Object>} Carrinho atualizado.\n */\n updateCartItem(productId, quantityChange) {\n    return this.request('/api/cart/add_item', {\n      method: 'POST',\n      body: JSON.stringify({ product_id: productId, quantity: quantityChange }),\n    });\n  },\n\n  /**\n   * Remove um produto espec\u00EDfico do carrinho.\n   * @param {number} productId - ID do produto.\n   * @returns {Promise<Object>} Carrinho atualizado.\n   */\n  removeFromCart(productId) {\n    return this.request(`/api/cart/${productId}`, {\n      method: 'DELETE',\n    });\n  },\n};\n", "import { el, mount } from './dom.js';\nimport { API } from './api.js';\n\nexport async function renderCart() {\n  const cartPanel = document.getElementById('cart-panel');\n  const cartItems = document.getElementById('cart-items');\n  const cartCount = document.getElementById('cart-count');\n  const cartTotal = document.getElementById('cart-total');\n\n  // Busca o carrinho\n  const cart = await API.getCart();\n\n  // Atualiza contadores\n  cartCount.textContent = cart.products?.length || 0;\n  cartTotal.textContent = (cart.total_price || 0).toFixed(2);\n\n  // Limpa o conte\u00FAdo anterior\n  cartItems.innerHTML = '';\n\n  if (!cart.products || cart.products.length === 0) {\n    mount(cartItems, el('p', {}, 'Carrinho vazio \uD83D\uDED2'));\n    return;\n  }\n\n  // Renderiza os itens\n  const items = cart.products.map((item) => {\n    const decreaseBtn = el('button', {\n      class: 'qty-btn',\n      onclick: () => handleQuantityChange(item, -1)\n    }, '\u2212');\n\n    const qtyDisplay = el('span', { class: 'qty' }, item.quantity.toString());\n\n    const increaseBtn = el('button', {\n      class: 'qty-btn',\n      onclick: () => handleQuantityChange(item, 1)\n    }, '+');\n\n    const removeBtn = el('button', {\n      class: 'remove-btn',\n      onclick: () => handleRemoveItem(item.id)\n    }, '\u2715');\n\n    const quantityControls = el('div', { class: 'quantity-controls' }, [\n      decreaseBtn, qtyDisplay, increaseBtn\n    ]);\n\n    return el('div', { class: 'cart-item' }, [\n      el('span', {}, item.name),\n      quantityControls,\n      el('span', {}, `R$ ${Number(item.total_price).toFixed(2)}`),\n      removeBtn\n    ]);\n  });\n\n  mount(cartItems, items);\n}\n\n// Fun\u00E7\u00F5es auxiliares\nasync function handleQuantityChange(item, change) {\n  const newQty = item.quantity + change;\n  if (newQty < 1) return; // evita zero ou negativo\n  await API.updateCartItem(item.id, change);\n  await renderCart();\n}\n\nasync function handleRemoveItem(productId) {\n  await API.removeFromCart(productId);\n  await renderCart();\n}\n\n/**\n * Alterna o painel lateral do carrinho.\n */\nexport function toggleCart() {\n  document.getElementById('cart-panel').classList.toggle('show');\n}\n", "import { el, mount } from './dom.js';\nimport { API } from './api.js';\nimport { renderCart } from './cart.js';\n\nexport async function renderProducts() {\n  const container = document.getElementById('products-list');\n  mount(container, el('p', {}, 'Carregando produtos...'));\n\n  const products = await API.getProducts();\n\n  if (!products.length) {\n    mount(container, el('p', {}, 'Nenhum produto dispon\u00EDvel.'));\n    return;\n  }\n\n  const items = products.map((p) =>\n    el('div', { class: 'product' }, [\n      el('img', {\n        src: `https://picsum.photos/seed/${p.id}/300/200`,\n        alt: p.name,\n        class: 'product-img',\n      }),\n      el('h3', {}, p.name),\n      el('p', {}, el('strong', {}, `R$ ${parseFloat(p.price || 0).toFixed(2)}`)),\n      el('button', {\n        class: 'add-btn',\n        onclick: async () => {\n          await API.addToCart(p.id);\n          await renderCart(); // atualiza o carrinho\n        },\n      }, 'Adicionar ao carrinho'),\n    ])\n  );\n\n  mount(container, items);\n}\n", "import { renderProducts } from './products.js';\nimport { renderCart, toggleCart } from './cart.js';\n\ndocument.addEventListener('DOMContentLoaded', async () => {\n  await renderProducts();\n  await renderCart();\n\n  document.getElementById('cart-toggle').addEventListener('click', toggleCart);\n  document.getElementById('checkout-btn').addEventListener('click', () => {\n    alert('\uD83D\uDE80 Esse \u00E9 apenas um demo visual, mas a API est\u00E1 100% funcional!');\n  });\n});\n"],
  "mappings": "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",
  "names": ["el", "tag", "attrs", "children", "node", "k", "v", "c", "mount", "root", "child", "API", "url", "options", "config", "response", "message", "error", "id", "productId", "quantity", "quantityChange", "renderCart", "cartPanel", "cartItems", "cartCount", "cartTotal", "cart", "API", "mount", "el", "items", "item", "decreaseBtn", "handleQuantityChange", "qtyDisplay", "increaseBtn", "removeBtn", "handleRemoveItem", "quantityControls", "change", "productId", "toggleCart", "renderProducts", "container", "mount", "el", "products", "API", "items", "p", "renderCart", "renderProducts", "renderCart", "toggleCart"]
}

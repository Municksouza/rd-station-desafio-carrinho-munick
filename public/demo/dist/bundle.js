function n(t,e={},a=[]){let r=document.createElement(t);return Object.entries(e).forEach(([o,s])=>{o==="class"?r.className=s:o.startsWith("on")&&typeof s=="function"?r.addEventListener(o.slice(2),s):r.setAttribute(o,s)}),(Array.isArray(a)?a:[a]).forEach(o=>{o!=null&&r.appendChild(typeof o=="string"?document.createTextNode(o):o)}),r}function c(t,e){t.innerHTML="",(Array.isArray(e)?e:[e]).forEach(a=>t.appendChild(a))}var i={async request(t,e={}){let a={headers:{"Content-Type":"application/json"},credentials:"same-origin",...e};try{let r=await fetch(t,a);if(!r.ok){let s=`Erro ${r.status}: ${r.statusText}`;throw console.error(`\u274C [API Error] ${s}`),new Error(s)}return await r.json().catch(()=>({}))}catch(r){return console.error("\u{1F6A8} Falha na requisi\xE7\xE3o:",r),alert("\u26A0\uFE0F Erro ao se comunicar com o servidor. Tente novamente."),{products:[],total_price:0}}},getProducts(){return this.request("/api/products")},getProduct(t){return this.request(`/api/products/${t}`)},getCart(){return this.request("/api/cart")},addToCart(t,e=1){return this.request("/api/cart/add_item",{method:"POST",body:JSON.stringify({product_id:t,quantity:e})})},updateCartItem(t,e){return this.request("/api/cart/add_item",{method:"POST",body:JSON.stringify({product_id:t,quantity:e})})},removeFromCart(t){return this.request(`/api/cart/${t}`,{method:"DELETE"})}};async function u(){let t=document.getElementById("cart-panel"),e=document.getElementById("cart-items"),a=document.getElementById("cart-count"),r=document.getElementById("cart-total"),o=await i.getCart();if(a.textContent=o.products?.length||0,r.textContent=(o.total_price||0).toFixed(2),e.innerHTML="",!o.products||o.products.length===0){c(e,n("p",{},"Carrinho vazio \u{1F6D2}"));return}let s=o.products.map(d=>{let y=n("button",{class:"qty-btn",onclick:()=>m(d,-1)},"\u2212"),g=n("span",{class:"qty"},d.quantity.toString()),f=n("button",{class:"qty-btn",onclick:()=>m(d,1)},"+"),h=n("button",{class:"remove-btn",onclick:()=>E(d.id)},"\u2715"),C=n("div",{class:"quantity-controls"},[y,g,f]);return n("div",{class:"cart-item"},[n("span",{},d.name),C,n("span",{},`R$ ${Number(d.total_price).toFixed(2)}`),h])});c(e,s)}async function m(t,e){t.quantity+e<1||(await i.updateCartItem(t.id,e),await u())}async function E(t){await i.removeFromCart(t),await u()}function l(){document.getElementById("cart-panel").classList.toggle("show")}async function p(){let t=document.getElementById("products-list");c(t,n("p",{},"Carregando produtos..."));let e=await i.getProducts();if(!e.length){c(t,n("p",{},"Nenhum produto dispon\xEDvel."));return}let a=e.map(r=>n("div",{class:"product"},[n("img",{src:`https://picsum.photos/seed/${r.id}/300/200`,alt:r.name,class:"product-img"}),n("h3",{},r.name),n("p",{},n("strong",{},`R$ ${parseFloat(r.price||0).toFixed(2)}`)),n("button",{class:"add-btn",onclick:async()=>{await i.addToCart(r.id),await u()}},"Adicionar ao carrinho")]));c(t,a)}document.addEventListener("DOMContentLoaded",async()=>{await p(),await u(),document.getElementById("cart-toggle").addEventListener("click",l),document.getElementById("checkout-btn").addEventListener("click",()=>{alert("\u{1F680} Esse \xE9 apenas um demo visual, mas a API est\xE1 100% funcional!")})});
//# sourceMappingURL=bundle.js.map
